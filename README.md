# 🚀 완벽한 키움 자동매매 시스템

GitHub THANOS-PROJECT/makemoney를 참고하여 완전히 새로 제작한 완벽한 키움증권 자동매매 시스템입니다.

## ✨ 주요 특징

### 🔐 완벽한 로그인 시스템
- ✅ **자동 로그인**: ID/PW 자동 입력
- ✅ **버전처리 자동 대응**: opstarter 창 자동 처리  
- ✅ **업그레이드 창 자동 닫기**: 무인 운영 지원
- ✅ **수동 로그인 지원**: 기존 방식도 완벽 지원

### 📈 20일 신고가 돌파 전략
- 🎯 **정확한 진입**: 거래대금 상위 200개 + 20일 신고가 돌파 + 거래량 200%
- 💰 **단계별 익절**: +3% 달성시 50% 매도, +6% 달성시 나머지 매도
- 🛡️ **엄격한 손절**: -2% 절대 손절
- ⏰ **안전한 시간**: 10:30-14:30만 매매
- 🎲 **리스크 관리**: 종목당 10%, 최대 5개 종목

### 🛡️ 완벽한 리스크 관리
- 📊 **일일 손실 한도**: 3% 초과시 자동 중지
- 📅 **월간 손실 한도**: 10% 초과시 월말까지 중지  
- 🔄 **연속 손절 제한**: 3회 연속 손절시 자동 중지
- ⏰ **강제 청산**: 14:30 이후 모든 포지션 정리

## 📁 프로젝트 구조

```
perfect-kiwoom-trading/
├── main.py                     # 메인 실행 파일
├── quick_test.py              # 빠른 테스트
├── requirements.txt           # 필수 라이브러리
├── START_HERE.md             # 시작 가이드
├── README.md                 # 프로젝트 설명서
│
├── library/                  # 핵심 라이브러리
│   └── kiwoom_api.py        # 완벽한 키움 API 클래스
│
└── strategy/                 # 매매 전략
    └── breakout_strategy.py  # 20일 신고가 돌파 전략
```

## 🛠️ 설치 및 설정

### 1. 시스템 요구사항
- **Windows 10/11** (필수)
- **Python 3.8+** (32비트 권장)
- **키움증권 계좌** + **OpenAPI+ 신청**
- **모의투자 계좌** (테스트용)

### 2. 키움 OpenAPI+ 설치
1. 키움증권 홈페이지에서 OpenAPI+ 다운로드
2. C:\\OpenAPI에 설치
3. KOA Studio 다운로드 후 동일 폴더에 복사
4. opversionup.exe 실행하여 최신 버전 업데이트

### 3. Python 환경 설정 (32비트 필수!)
```bash
# Anaconda로 32비트 환경 생성
conda create -n kiwoom32 python=3.8
conda activate kiwoom32
conda config --env --set subdir win-32
conda install python=3.8

# 필수 라이브러리 설치
pip install -r requirements.txt
```

### 4. 프로젝트 다운로드
```bash
git clone https://github.com/cojay80/perfect-kiwoom-trading.git
cd perfect-kiwoom-trading
```

## 🚀 사용법

### 1. 빠른 테스트 (권장)
```bash
python quick_test.py
```

### 2. 전체 시스템 실행
```bash
python main.py
```

### 3. 로그인 방식 선택
```
📋 로그인 방식을 선택하세요:
1. 수동 로그인 (팝업창 직접 입력)  ← 안전함
2. 자동 로그인 (ID/PW 자동 입력)  ← 편리함

선택 (1 또는 2): 2
```

### 4. 자동매매 전략 선택  
```
🎯 자동매매 전략을 선택하세요:
1. 20일 신고가 돌파 전략     ← 추천!
2. 실시간 모니터링만
3. 건너뛰기

전략 선택 (1, 2, 3): 1
```

## 📊 전략 상세 설명

### 🎯 20일 신고가 돌파 전략 (1단계 - 심플 버전)

#### 진입 조건 (모두 만족시)
1. **거래대금 상위 200개 종목**
2. **20일 신고가 돌파** 
3. **거래량 200% 이상 증가**
4. **매매 시간**: 10:30 ~ 14:30

#### 청산 조건
- **1차 익절**: +3% 달성시 → 50% 매도
- **2차 익절**: +6% 달성시 → 나머지 전량 매도  
- **손절**: -2% 도달시 → 즉시 전량 매도

#### 리스크 관리
- **종목당 투자**: 전체 자금의 10%
- **최대 보유**: 동시 5개 종목까지
- **일일 한도**: -3% 손실시 당일 매매 중지
- **연속 손절**: 3회 연속시 시스템 자동 중지

## 📈 예상 수익률

```
🎯 현실적 기대 수익 (복리 적용)
1년차: 월 3% (연 43%) → 100만원 → 143만원
2년차: 월 5% (연 80%) → 143만원 → 257만원  
3년차: 월 7% (연 125%) → 257만원 → 578만원
```

## ⚠️ 중요 안전 수칙

### 🔴 반드시 지켜야 할 것들
1. **모의투자부터 시작**: 최소 3개월 이상 테스트
2. **소액으로 시작**: 처음엔 100만원 정도로 시작
3. **손절 절대 준수**: -2% 도달시 반드시 매도
4. **일일 한도 준수**: -3% 손실시 당일 매매 중지
5. **정기적 점검**: 주간/월간 성과 분석 필수

### 🟡 권장사항
- 장 시작 전 시스템 상태 확인
- 중요 경제 이벤트 일정은 미리 체크
- 시장 변동성 큰 날은 포지션 규모 축소
- 정기적으로 전략 파라미터 최적화

## 🐛 문제 해결

### 자주 발생하는 문제들

#### 1. 로그인 창이 숨어있을 때
- 작업 관리자에서 "Open API Login" 프로세스 확인
- 숨어있는 창을 Alt+Tab으로 찾기

#### 2. 버전처리 무한 대기
- opversionup.exe를 관리자 권한으로 재실행
- 키움 HTS 완전 종료 후 재시작

#### 3. TR 요청 실패 (-200 오류)
- 1초에 5회 제한 초과 → 잠시 대기 후 재시도
- 시간 간격을 0.5초 → 1초로 조정

#### 4. 계좌번호 None 오류
- 로그인 후 GetLoginInfo 재호출
- 모의투자 체크박스 상태 확인

## 📞 지원 및 문의

### 📚 참고 자료
- [키움 OpenAPI+ 개발가이드](https://download.kiwoom.com/web/openapi/kiwoom_openapi_plus_devguide_ver_1.1.pdf)
- [GitHub THANOS-PROJECT/makemoney](https://github.com/THANOS-PROJECT/makemoney)
- [키움증권 OpenAPI 사용법](https://www.kiwoom.com/h/customer/download/VOpenApiInfoView)

### 🆘 문제 신고
- GitHub Issues 탭에서 문제 신고
- 오류 로그와 함께 상세한 상황 설명
- 재현 가능한 단계별 설명

## 📋 개발 로드맵

### 🎯 1단계 (완료) - 심플 버전
- ✅ 기본 로그인 시스템
- ✅ 20일 신고가 돌파 전략
- ✅ 기본 리스크 관리
- ✅ 실시간 모니터링

### 🎯 2단계 (4-6개월) - 중급 버전
- 🔄 RSI 45-70 조건 추가
- 🔄 체결강도 150% 조건
- 🔄 3단계 분할 매도
- 🔄 ATR 보조 손절

### 🎯 3단계 (7-12개월) - 고급 버전
- 🔄 VIX/코스피 시장 필터
- 🔄 A/B/C급 포지션 사이징
- 🔄 4단계 분할 매도
- 🔄 완전 ATR 기반 시스템

## 💎 핵심 철학

> **"완벽한 예측보다 확률적 우위, 큰 수익보다 꾸준한 수익"**

이 시스템은 단기간에 큰 수익을 추구하기보다는, 장기간에 걸쳐 안정적이고 지속 가능한 수익을 목표로 합니다.

**돈 지키기 > 돈 벌기** 원칙을 철저히 준수하여, 계좌 보호를 최우선으로 하는 보수적인 접근 방식을 취합니다.

---

## 🏆 성공을 위한 마지막 조언

1. **인내심을 가지세요**: 단기간의 손실에 흔들리지 마세요
2. **규칙을 지키세요**: 감정적 판단보다는 시스템을 믿으세요  
3. **꾸준히 학습하세요**: 시장은 항상 변하므로 지속적인 학습이 필요합니다
4. **겸손하세요**: 시장을 이길 수 있다고 과신하지 마세요
5. **안전을 우선하세요**: 큰 수익보다는 안전한 수익을 추구하세요

**이제 안전하게 모의투자부터 시작해보세요!** 💰🚀

---

### 📄 라이선스

이 프로젝트는 MIT 라이선스 하에 배포됩니다.

### 🙏 감사의 말

GitHub THANOS-PROJECT/makemoney 프로젝트에서 많은 영감을 받았습니다. 
오픈소스 커뮤니티의 지식 공유 정신에 감사드립니다.
